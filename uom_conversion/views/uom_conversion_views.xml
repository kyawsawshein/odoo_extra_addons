<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <record id="action_consume" model="ir.actions.act_window">
        <field name="name">Consume</field>
        <field name="res_model">stock.picking</field>
        <field name="view_mode">list,form</field>
    </record>
    <record id="view_uom_conversion_form" model="ir.ui.view">
        <field name="name">uom.conversion</field>
        <field name="model">uom.conversion</field>
        <field name="arch" type="xml">
            <form string="Transfer">
                <header>
                    <field name="consume_id" invisible="1" />
                    <button name="do_transfer" type="object" string="Confirm" class="oe_highlight" invisible="state!='draft'" />
                    <button name="compute_finit_price" type="object" string="Recompute prices" invvisible="state!='draft'" />
                    <field name="state" widget="statusbar" />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button type="object" class="oe_stat_button" id="consume_button" icon="fa-angle-down" name="open_consume" invisible="state=='draft'">
                            <span class="o_stat_text">Consume</span>
                        </button>
                        <button type="object" class="oe_stat_button" id="consume_button" icon="fa-angle-up" name="open_receipt" invisible="state=='draft'">
                            <span class="o_stat_text">Receipt</span>
                        </button>
                    </div>
                    <group>
                        <group>
                            <field name="name" force_save="1" />
                            <field name="date" readonly="state!='draft'" />
                        </group>
                        <group>
                            <field name="validation_consume" readonly="state!='draft'" />
                            <field name="validation_receipt" readonly="state!='draft'" />
                        </group>
                        <group>
                            <field name="picking_type_consume" readonly="state!='draft'" />
                            <field name="picking_type_receipt_production" readonly="state!='draft'" />
                        </group>
                        <group>
                            <field name="location_src_id" readonly="state!='draft'" />
                            <field name="location_dest_id" readonly="state!='draft'" />
                        </group>
                    </group>

                    <div class="o_row">
                        <div class="o_col-6">
                            <label for="product_out_ids" string="Consume" />
                            <field name="product_out_ids" nolabel="1" readonly="state!='draft'">
                                <list editable="bottom">
                                    <field name="product_id" options="{'no_create':True}"/>
                                    <field name="stock"/>
                                    <field name="lot_ids" widget="many2many_tax_tags" options="{'no_create':True}"/>
                                    <field name="lot_qty"/>
                                    <field name="quantity" sum="1" />
                                    <field name="price_unit" readonly="1" force_save="1" />
                                    <field name="uom_id" />
                                    <field name="value" sum="1" />
                                </list>
                            </field>
                        </div>
                        <div class="o_col-6">
                            <label for="product_in_ids" string="Receipt" />
                            <field name="product_in_ids" nolabel="1" readonly="state!='draft'">
                                <list editable="bottom">
                                    <field name="product_id" options="{'no_create':True}"/>
                                    <field name="quantity" sum="1" />
                                    <field name="uom_id" />
                                    <field name="price_unit" readonly="1" force_save="1" />
                                    <field name="value" sum="1" />
                                    <field name="lot_name"/>
                                </list>
                            </field>
                        </div>
                    </div>

                </sheet>
            </form>
        </field>
    </record>


    <record id="uom_conversion_list" model="ir.ui.view">
        <field name="name">uom.conversion.list</field>
        <field name="model">uom.conversion</field>
        <field name="arch" type="xml">
            <list>
                <field name="name" />
                <field name="date" />
            </list>
        </field>
    </record>

    <record id="action_uom_conversion" model="ir.actions.act_window">
        <field name="name">UOM Conversion</field>
        <field name="res_model">uom.conversion</field>
        <field name="view_mode">list,form</field>
        <field name="target">current</field>
    </record>

    <menuitem id="menu_uom_conversion" name="UOM Conversion" action="action_uom_conversion" parent="stock.menu_stock_warehouse_mgmt" />
</odoo>
